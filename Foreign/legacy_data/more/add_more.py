#!/usr/bin/env python# -*- coding: utf-8 -*-# cat sitecustomize.py# encoding=utf8 from unidecode import unidecode import sys  reload(sys)  sys.setdefaultencoding('utf8')import inspectimport shutilfrom datetime import datetime, dateimport MySQLdbimport numpy as npimport jsonimport urllib2import MySQLdbimport pandas as pdfrom sqlalchemy import create_engineimport urllib, urllib2, cookielibimport csvimport osimport numpy as np# file coding: utf-16le with domdef get_data(path):	df = pd.read_csv(path,sep='\t',engine='python')	return dfcurrent_folder = os.path.dirname(os.path.abspath(inspect.getfile(inspect.currentframe())))file_name_array = []def text_clean(text):	text = text.replace('—','-')	text = text.replace('）',')').replace('（','(')	text = text.replace(' ','')	text = text.replace('/',':')	text = text.replace('.txt','')	text = text.replace('.txt','')	return textfirst = Truedf_all = Nonefirst = Truespec_folder = current_folder# show all csv file name in specific folderfor path, subdirs, files in os.walk(spec_folder):	for name in files:		print name		#print name		if '.txt' in name:		#if '霸菱全球新興市場基金' in name:			path = spec_folder+'/'+name			#print path			date_arr = []			net_arr = []			#print name			f = open(name,'rb')			for row in f.readlines():				row = row.replace(' ','')				row = row.replace('\n','')				row = row.replace('\r','')				arr = row.split('\t')				if arr[0]=='日期':					##skip weekend					for date in arr[2:-1]:						date_arr.append(date.replace('/','-'))				if arr[0]=='淨值':					##skip weekend					for net in arr[2:-1]:						if net == '--' or net == 'N/A':							net_arr.append(np.nan)						else:							net_arr.append(net)			name = text_clean(name)			tmp_df = pd.DataFrame({'日期':date_arr,name:net_arr})			tmp_df = tmp_df[['日期',name]]						if first:				df_all = tmp_df				first = False			else:				df_all = df_all.merge(tmp_df[tmp_df['日期']!=''], how='inner',on=['日期'])	df_all.to_csv('tmp-Foreign.csv', index=False)df_all = pd.read_csv('all-Foreign-df.csv')df_new = pd.read_csv('tmp-Foreign.csv')df_all.index = df_all['日期']for index, row in df_new.iterrows():	row = row.to_dict()	date=row['日期']	row.pop('日期')	for key, value in row.iteritems():		## 3 years only		key = text_clean(key)		#print key		df_all.loc[date, key] = valuedf_all.to_csv('all-Foreign-df.csv', index=False)