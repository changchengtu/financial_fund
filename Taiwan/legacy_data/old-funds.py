#!/usr/bin/env python# -*- coding: utf-8 -*-# cat sitecustomize.py# encoding=utf8 from unidecode import unidecode import sys  reload(sys)  sys.setdefaultencoding('utf8')import inspectimport shutilfrom datetime import datetime, dateimport MySQLdbimport numpy as npimport jsonimport urllib2import MySQLdbimport pandas as pdfrom sqlalchemy import create_engineimport urllib, urllib2, cookielibimport csvimport os# file coding: utf-16le with domdef get_data(path):	df = pd.read_csv(path,sep='\t',engine='python')	return dfcurrent_folder = os.path.dirname(os.path.abspath(inspect.getfile(inspect.currentframe())))folder_name_array = ['201306','201307','201308','201309','201310','201311','201312',					'201401','201402','201403','201404','201405','201406','201407',					'201408','201409','201410','201411','201412','201501','201502',					'201503','201504','201505']file_name_array = []first = Truedf_all = Nonefor folder in folder_name_array:	print folder	spec_folder = current_folder+'/legacy_data/'+folder	# show all csv file name in specific folder	for path, subdirs, files in os.walk(spec_folder):		for name in files:			if ".csv" in name:				#f = os.path.join(name)				path = spec_folder+'/'+name				date = name[:4]+'-'+name[4:6]+'-'+name[6:].split('.')[0]				## build dataframe				if first:					df_all = get_data(path)					df_all['日期'] = date					first = False				else: 					tmp = get_data(path)					tmp['日期'] = date					df_all = df_all.append(tmp)df_all = df_all.reset_index(drop=True)df_all = df_all.rename(columns={'公司代號':'會員代號','淨值':'基金淨值'})df_all = df_all.drop('前一日淨值', 1)cols = df_all.columns.tolist()#cols = cols[:-1]+cols[1:3]+cols[4]+cols[5]+cols[7:8]df_all = df_all[['日期','會員代號','公司名稱','基金統編','基金名稱','基金淨值','漲跌','類型代號','幣別','受益憑證代號']]#df_all.to_sql('funds', mysql_cnxn,schema='financial',flavor='mysql',if_exists='replace',index=False)df_all.to_csv('all-Taiwan.csv', index=False)